# GraphQL Mutation Registration: Vulnerability or Not?

##  When is it **not** a vulnerability?
User registration through a GraphQL `mutation` is **normal behavior** if:

- The application **offers a public sign-up feature** for visitors.
- Allows anyone **(even unauthenticated users)** to register..
- Newly registered users **don't get elevated privileges** (e.g., no `Admin`, `Support`, etc.).
- Identity or email is **properly validated** (e.g., email confirmation, domain restrictions (admin@company.com), etc.).

>  Then this behavior is **not a vulnerability**, it's intended by design.

---

##  When does it become a **vulnerability**?

### 1. **Privilege Escalation / Mass assignment**
- You are able to assign special roles in the mutation input like:  
  ```graphql
  mutation {
    createUser(input: { name: "Test", email: "a@b.com", password: "123", role: "admin" }) {
      user { id name role }
    }
  }
  ```
- New users get unintended high privileges like `admin`, `moderator`, or `support`.

>  **Severity:** High – Critical

---

### 2. **Impersonation / Email Spoofing**
- No email verification is required.
- No domain or identity validation.
- Able to register with trusted emails like `admin@company.com`.

> **Severity:** Low – Medium

---

### 3. **Mass registration / spam account creation**
- Able to create thousands of accounts using automation (e.g., Burp Suite Intruder).
- No CAPTCHA, no rate limiting, or IP blocking.

>  **Severity:** Medium – High

---

### 4. **Unauthorized registration on private systems**
- The system is meant to be **private or invite-only**.
- But the registration mutation is still exposed and working for external users.

>  **Severity:** High

---

## Summary table

| Situation                                      | Vulnerability? | Severity            |
|------------------------------------------------|----------------|---------------------|
| Normal user registration (Open system)         |  No          | Not a vulnerability   |
| No identity/email verification                 |  Possibly     | Low – Medium         |
| Able to assign roles (e.g., Admin)             |  Yes          | High – Critical      |
| Registration exposed in restricted system      |  Yes          | High                 |
| Able to automate thousands of registrations    |  Yes          | Medium – High        |
